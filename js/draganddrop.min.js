var module=angular.module("lvl.directives.dragdrop",["lvl.services"]);module.directive("lvlDraggable",["$rootScope","uuid",function(e,r){return{restrict:"A",scope:{onDrag:"&"},link:function(a,i){console.log("linking draggable element"),angular.element(i).attr("draggable","true");var l=angular.element(i).attr("id");l||(l=r.new(),angular.element(i).attr("id",l)),i.bind("dragstart",function(r){r.dataTransfer.setData("text",l),e.$emit("LVL-DRAG-START");var i=r.dataTransfer.getData("text"),t=document.getElementById(i);a.onDrag({dragEl:t})}),i.bind("dragend",function(){e.$emit("LVL-DRAG-END")})}}}]),module.directive("lvlDropTarget",["$rootScope","uuid",function(e,r){return{restrict:"A",scope:{onDrop:"&"},link:function(a,i){var l=angular.element(i).attr("id");l||(l=r.new(),angular.element(i).attr("id",l)),i.bind("dragover",function(e){return e.preventDefault&&e.preventDefault(),e.dataTransfer.dropEffect="move",!1}),i.bind("dragenter",function(e){angular.element(e.target).addClass("lvl-over")}),i.bind("dragleave",function(e){angular.element(e.target).removeClass("lvl-over")}),i.bind("drop",function(e){e.preventDefault&&e.preventDefault(),e.stopPropogation&&e.stopPropogation();var r=e.dataTransfer.getData("text"),i=document.getElementById(l),t=document.getElementById(r);a.onDrop({dragEl:t,dropEl:i})}),e.$on("LVL-DRAG-START",function(){var e=document.getElementById(l);angular.element(e).addClass("lvl-target")}),e.$on("LVL-DRAG-END",function(){var e=document.getElementById(l);angular.element(e).removeClass("lvl-target"),angular.element(e).removeClass("lvl-over")})}}}]);